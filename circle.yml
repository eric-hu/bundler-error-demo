experimental:
  picard:
    version: 0.1
    executorType: docker
    containerInfo:
      #- image: ruby:2.3.1
      - image: justincampbell/capybara-webkit:2.3
      #- image: postgres:9.4.1
        #env:
          #- POSTGRES_USER=root
    stages:
      build:
        workDir: /home/ubuntu/canary-rails
        steps:
          - type: checkout
          # Create Postgres users and database, shows how to use a YAML heredoc
          # to provide nicer formatting
          - type: shell
            shell: /bin/bash
            command: |
              bundle install
          #- type: shell
            #shell: /bin/bash
            #command: |
              #sudo -u root createuser -h localhost --superuser ubuntu &&
              #sudo createdb -h localhost test_db

              #mkdir -p config
              #echo 'test:
                #database: circle_ruby_test
                #adapter: postgresql
                #pool: 5
                #timeout: 5000
                #username: ubuntu
                #host: localhost
              #' > config/database.yml

              #rake db:create db:schema:load
          # Run tests, demonstrates using a larger script as the test command
          # along with additional environment variables
          #- type: shell
            #shell: /bin/bash
            #command: |
                #set -exu
                #mkdir -p /tmp/artifacts
                #bundle exec rspec --require spec_helper --format RspecJunitFormatter --out out/tests/rspec.xml
                #cp out/tests/*.xml /tmp/artifacts/

            #environment:
              #SSH_TARGET: "localhost"
              #TEST_ENV: "linux"

          # Save artifacts
          #- type: artifacts-store
            #path: /tmp/artifacts
            #destination: build
